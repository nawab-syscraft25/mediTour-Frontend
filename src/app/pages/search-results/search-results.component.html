<div class="container-fluid py-4">
  <!-- Search Header -->
  <div class="row mb-4">
    <div class="col-12">
      <div class="search-header">
        <h2 class="mb-2">Search Results</h2>
        <p class="text-muted" *ngIf="searchQuery">
          Showing results for "<strong>{{ searchQuery }}</strong>"
          <span *ngIf="totalResults > 0">({{ totalResults }} results found)</span>
        </p>
      </div>
    </div>
  </div>

  <!-- Loading State -->
  <div *ngIf="loading" class="text-center py-5">
    <div class="spinner-border text-primary" role="status">
      <span class="visually-hidden">Loading...</span>
    </div>
    <p class="mt-3">Searching...</p>
  </div>

  <!-- Search Results -->
  <div *ngIf="!loading && searchResults">

    <!-- Doctors Section -->
    <div *ngIf="searchResults.doctors?.count > 0">
      <h3 class="section-title mb-4">
        <i class="fas fa-user-md me-2"></i>
        Doctors ({{ searchResults.doctors.count }})
      </h3>
      <div class="row">
        <div *ngFor="let doctor of searchResults.doctors.data" class="col-lg-4 col-md-6 mb-4">
          <div class="user-card" (click)="navigateToDoctor(doctor.id)">
            <div class="card-inner">
              <div class="user-card-img">
                <img class="img-fluid"
                  [src]="getDoctorImageUrl(doctor)"
                  [alt]="doctor.name"
                  (error)="onImageError($event)">
              </div>
              <div class="user-card-content doctors-card-info">
                <h5 class="card-title">{{ doctor.name }}</h5>
                <div class="user-card-description">
                  <p class="card-text" *ngIf="doctor.short_description">
                    {{ doctor.short_description }}
                  </p>
                </div>
                <div class="user-card-rating d-flex align-items-center" *ngIf="doctor.rating">
                  <ng-container *ngFor="let star of getStars(doctor.rating)">
                    <!-- Full star -->
                    <i *ngIf="star === 'full'" class="fa fa-star text-warning"></i>
                    <!-- Half star -->
                    <i *ngIf="star === 'half'" class="fa fa-star-half-alt text-warning"></i>
                    <!-- Empty star -->
                    <i *ngIf="star === 'empty'" class="fa-regular fa-star text-warning"></i>
                  </ng-container>
                </div>
                <div class="d-flex align-items-center card-location">
                  <img src="assets/images/d-designation.svg">
                  <p class="mb-0" *ngIf="doctor.designation">{{ doctor.designation }}</p>
                </div>
                <div class="d-flex align-items-center card-location">
                  <img src="assets/images/fees.svg">
                  <p *ngIf="doctor.consultancy_fee" class="mb-0">Consultation Fees <span class="fee-amount">â‚¹{{ doctor.consultancy_fee }}</span></p>
                </div>
                <div class="d-flex align-items-center card-location">
                  <img src="assets/images/d-hospital.svg">
                  <p class="mb-0">CHL HOSPITAL</p>
                </div>
                <div class="d-flex align-items-center card-location">
                  <img src="assets/images/d-experience.svg">
                  <p class="mb-0" *ngIf="doctor.experience_years">{{ doctor.experience_years }} Years of Experience</p>
                </div>
              </div>
            </div>
            <!-- More Detail -->
            <div class="read-more">
              <a *ngIf="doctor.id" [attr.href]="'/doctor-details/' + doctor.id" class="btn">
                More Detail <i class="fa fa-arrow-up"></i>
              </a>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Treatments Section -->
    <div *ngIf="searchResults.treatments?.count > 0">
      <h3 class="section-title mb-4">
        <i class="fas fa-procedures me-2"></i>
        Treatments ({{ searchResults.treatments.count }})
      </h3>
      <div class="row">
        <div *ngFor="let treatment of searchResults.treatments.data" class="col-lg-4 col-md-6 mb-4">
          <div class="user-card" (click)="navigateToTreatment(treatment.id)">
            <div class="card-inner">
              <div class="user-card-img">
                <img class="img-fluid"
                  src="http://165.22.223.163:8000/media/treatment/3e1e1331-b8c9-449c-b8ee-b80da0212872.jpg"
                  alt="Nawab Khan"><!--container-->
              </div>
              <div class="user-card-content">
                <h5 class="card-title">{{ treatment.name }}</h5>
                <div class="user-card-description">
                  <p class="card-text" *ngIf="treatment.short_description">
                    {{ treatment.short_description }}
                  </p>
                </div>
                <div class="user-card-rating" *ngIf="treatment.rating">
                  <div class="user-card-rating d-flex align-items-center">
                    <ng-container *ngFor="let star of getStars(treatment.rating)">
                      <!-- Full star -->
                      <i *ngIf="star === 'full'" class="fa fa-star text-warning"></i>
                      <!-- Half star -->
                      <i *ngIf="star === 'half'" class="fa fa-star-half-alt text-warning"></i>
                      <!-- Empty star -->
                      <i *ngIf="star === 'empty'" class="fa-regular fa-star text-warning"></i>
                    </ng-container>
                    <span class="ms-2" *ngIf="treatment.rating !== null"></span>
                  </div>
                </div>
                <div class="price-section">
                  <p class="treatment-price"><strong>Price:</strong> {{ formatPrice(treatment) }} <span
                      class="ms-1">Onward</span></p>
                </div>
                <div class="d-flex align-items-center card-location" *ngIf="treatment.location">
                  <img _ngcontent-ng-c1372934940="" src="assets/images/card-location.svg">
                  <p class="user-card-location mb-0">{{ treatment.location }}</p>
                </div>
              </div>
            </div>
            <!-- More Detail -->
            <div class="read-more">
              <a *ngIf="treatment.id" [attr.href]="'/treatment-detail/' + treatment.id" class="btn">
                More Detail <i class="fa fa-arrow-up"></i>
              </a>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Hospitals Section -->
    <div *ngIf="searchResults.hospitals?.count > 0">
      <h3 class="section-title mb-4">
        <i class="fas fa-hospital me-2"></i>
        Hospitals ({{ searchResults.hospitals.count }})
      </h3>
      <div class="row">
        <div *ngFor="let hospital of searchResults.hospitals.data" class="col-lg-4 col-md-6 mb-4">
          <div class="user-card hospital-card" (click)="navigateToHospital(hospital.id)">
            <div class="card-inner">
              <div class="user-card-img">
                <img class="img-fluid" [src]="getHospitalImageUrl(hospital)" [alt]="hospital.name"
                  (error)="onImageError($event)">
              </div>
              <div class="user-card-content">
                <h5 class="card-title">{{ hospital.name }}</h5>
                <div class="user-card-description">
                <p class="card-text truncate-2" *ngIf="hospital.description">
                  {{ hospital.description }}
                </p>
                </div>
                <div class="d-flex align-items-center card-location" *ngIf="hospital.location">
                  <img src="assets/images/card-location.svg">
                  <p class="user-card-location mb-0">{{ hospital.location }}</p>
                </div>

                <!-- <div class="mb-2" *ngIf="hospital.rating">
                  <div class="rating">
                    <ng-container *ngFor="let star of getStars(hospital.rating)">
                      <i *ngIf="star === 'full'" class="fa fa-star text-warning"></i>
                      <i *ngIf="star === 'half'" class="fa fa-star-half-alt text-warning"></i>
                      <i *ngIf="star === 'empty'" class="fa-regular fa-star text-warning"></i>
                    </ng-container>
                    <span class="rating-text ms-1">({{ hospital.rating }})</span>
                  </div>
                </div> -->
              </div>
              <div class="read-more">
                <a *ngIf="hospital.id" [attr.href]="'/hospital-detail/' + hospital.id" class="btn">
                    More Detail <i class="fa fa-arrow-up"></i>
                </a>
            </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- No Results -->
    <div *ngIf="!searchResults.doctors?.count && !searchResults.treatments?.count && !searchResults.hospitals?.count"
      class="text-center py-5">
      <div class="no-results">
        <i class="fas fa-search fa-3x text-muted mb-3"></i>
        <h4>No results found</h4>
        <p class="text-muted">Try searching with different keywords or check your spelling.</p>
      </div>
    </div>
  </div>

  <!-- No Search Query -->
  <div *ngIf="!loading && !searchQuery" class="text-center py-5">
    <div class="no-search">
      <i class="fas fa-search fa-3x text-muted mb-3"></i>
      <h4>Start your search</h4>
      <p class="text-muted">Enter a search term to find doctors, treatments, and hospitals.</p>
    </div>
  </div>
</div>